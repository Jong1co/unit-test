# Chapter 1 단위 테스트의 목표

- 단위 테스트는 단순히 테스트를 작성하는 것보다 더 큰 범주임
- 노력을 줄이고 이득을 최대화해야 함.

### 1.1 단위 테스트 현황

- 단위 테스트를 독려하는 분위기가 자리잡아, 논쟁의 목적은 "단위 테스트를 작성해야 하는가?" 에서 "좋은 단위 테스트를 작성하는 것은 어떤 의미인가"로 바뀌게 되었다.

### 1.2 단위 테스트의 목표

- 단위 테스트를 작성하면 일반적으로 설계는 좋아지지만, 이는 주목표가 아닌 좋은 사이드 이펙트일 뿐이다.
  - 단위 테스트가 어렵다면 코드 개선이 반드시 필요하다는 것을 나타낸다.
  - 강결합에서 저품질이 나타나는데, 강결합이란 제품 코드가 서로 충분히 분리되지 않아서 따로 테스트하기 어려움을 뜻함
- 테스트 없이는 프로젝트가 진행될 수록 개발 속도가 현저히 줄어드는데, 이를 소프트웨어 엔트로피 라고도 한다. (코드베이스에서 무언가를 변경할 때마다 무질서도는 증가한다.)

### 1.3 테스트 스위트 품질 측정을 위한 커버리지 지표

**테스트 스위트 :** 개별 테스트를 묶어 하나의 자원으로 제공함으로써 여러 테스트를 한 번에 실행할 수 있고, 반복해서 간단히 실행할 수 있게 하는 것

커버리지 지표는 괜찮은 부정 지표이지만 좋지 않은 긍정 지표이다. <br/>
커버리지가 너무 적을 때는 충분하지 않다는 증거이며, 높은 커버리지라고 해서 반드시 양질의 테스트라고 보장하지 않는다.

코드 커버리지 = 실행 코드 라인 수 / 전체 라인 수

다음과 같은 코드가 있을 때, 커버리지로 장난을 칠 수 있다.

```js
//input = 'abc'

//AS-IS
const isStringLong = (
  input //
) => {
  if (input.length > 5) {
    return true;
  }
  return false;
};

//TO-BE
const isStringLong = (
  input //
) => {
  return input.length > 5;
};
```

이렇게 코드를 변경하는 것 만으로도 테스트 커버리지는 증가한다. <br/>
그렇기 때문에, 커버리지는 좋은 부정 지표이자, 나쁜 긍정 지표인 것이다.

**분기 커버리지**

분기 커버리지는 코드 라인 수를 사용하는 대신, if, switch문과 같은 제어 구조에 중점을 둠

**커버리지 지표에 관한 문제점**

- 분기 커버리지로 코드 커버리지보다 더 나은 결과를 얻을 수 있지만, 테스트 스위트의 품질을 결정하는 데 어떤 커버리지 지표도 의존할 수 없음

- 테스트 대상 시스템의 모든 가능한 결과를 검증한다고 보장할 수 없음
  - 암묵적인 결과 혹은 사이드 이펙트가 있을 수 있기 때문에 (그렇다면 최대한 사이드 이펙트를 발생시키는 것이 아닌, 순수함수로만 만들면 괜찮다는 뜻일까?)
  - 결과 검증이 없을 경우에는 무조건 테스트 통과기 때문에
- 외부 라이브러리 코드 경로를 고려할 수 있는 커버리지 지표는 없음

**특정 커버리지 숫자를 목표로 하면 안 된다!**

- 커버리지 지표를 보는 가장 좋은 방법은 지표 그 자체로 보는 것이며, 목표로 여겨서는 안 된다.
  - ex) 병원 환자의 체온이 높으면 열이 난다는 것을 의미할 수 있으며, 이는 유용한 관찰이다.
  - 그러나 병원은 환자의 적절한 체온을 목표로 해서는 안 된다.
  - 환자 옆에 에어컨을 설치해서 효율적으로 빨리 끝낼 수도 있지만 이런 접근은 의미가 없다.
- 위 예시와 마찬가지로 커버리지 숫자를 목표로 하면 사람들은 중요한 것을 테스트하는 데 집중하는 대신 인공적인 목표를 달성하기 위한 방법을 찾기 시작한다.
